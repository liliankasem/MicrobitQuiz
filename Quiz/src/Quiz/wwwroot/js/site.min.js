var app=angular.module("QuizApp",[]).controller("QuizCtrl",function(e,t,n,s){app.config(["$httpProvider",function(e){e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"],delete e.defaults.headers.common["x-csrftoken"],e.defaults.headers.post.Accept="application/json, text/javascript",e.defaults.headers.post["Content-Type"]="application/json; charset=utf-8",e.defaults.headers.post["Access-Control-Allow-Methods"]="GET, POST, OPTIONS"}]),e.answered=!1,e.title="Loading question...",e.options=[],e.correctAnswer=!1,e.disabled=!1,e.counter=0,e.numQuestions=5,e.score=0,e.attempt=0,e.badgeResult="",e.answerHidden=!0,e.tryAgain="",e.rightAnswer="",e.answerDisabled=!0,e.redirected="",e.answer=function(){return e.correctAnswer?"Correct":"Incorrect"},e.checkQuestions=function(){return e.disabled=!0,0!=e.numQuestions?e.nextQuestion():(e.tryAgain="",e.options=[],e.title="End",e.score>=4?(e.badgeResult="pass",e.title="Well done! You passed.",e.redirected="You will be redirect to iDEA."):(e.badgeResult="fail",e.title="Uh oh, looks like you didn't pass! You need to successfully pass the quiz to achieve the badge.",e.redirected="You will be redirect to iDEA - go on give it another go!"),e.answerHidden=!0,e.sendAnswer(e.badgeResult),void(e.disabled=!1))},e.nextQuestion=function(){e.tryAgain="",e.disabled=!0,e.answered=!1,e.title="Loading question...",e.options=[],e.question=[],t.get("http://quizapi.azurewebsites.net/api/TriviaQuestions?name="+quizName).success(function(t,n,s,o){e.question=t[e.counter],e.options=e.question.Options,e.title=e.question.Title,e.answered=!1,e.disabled=!1,e.numQuestions--,e.counter++,e.attempt=0}).error(function(t,n,s,o){e.title="Oops... something went wrong inside: http.get nextQuestion()",e.disabled=!1})},e.checkAnswer=function(t){e.disabled=!0,e.answered=!0,e.answerHidden=!1,1==t.IsCorrect?(e.score++,e.correctAnswer=!0,e.answerDisabled=!0,e.checkQuestions()):0==t.IsCorrect&&e.attempt<1?(e.answered=!1,e.disabled=!1,e.attempt++,e.correctAnswer=!1,e.tryAgain="| Try 1 more time!"):(e.correctAnswer=!1,e.answerDisabled=!1,e.getRightAnswer(),e.checkQuestions())},e.getRightAnswer=function(){angular.forEach(e.options,function(t){return t.IsCorrect===!0?void(e.rightAnswer="The correct answer was: "+t.Title):void 0})},e.sendAnswer=function(o){e.disabled=!0,e.answered=!0,e.token=token,e.apiKey=apiKey,e.postUrl="https://idea.org.uk/api/result?apiKey="+e.apiKey+"&token="+e.token,t({method:"POST",url:e.postUrl,data:"result="+o,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){s(function(){n.location=e.redirectUrl},3e3)}).error(function(){e.title="Oops... something went wrong inside: http.post sendAnswer()",e.disabled=!1})}});